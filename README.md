# OpenAPI Generator Learning

å˜ä¸€ã® openapi.yaml ã‚’ã‚‚ã¨ã«ã€4ã¤ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆã‚¹ã‚¿ãƒƒã‚¯ã‚’æ¯”è¼ƒã§ãã‚‹ pnpm monorepo ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install

# ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼å«ã‚€ï¼‰
pnpm run dev
```

## ğŸ› ï¸ é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

```bash
# ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚³ãƒ¼ãƒ‰ã‚’ä¸¦è¡Œç”Ÿæˆ
pnpm run generate
```

### æ¤œè¨¼ãƒ»ãƒ“ãƒ«ãƒ‰

```bash
# ãƒ“ãƒ«ãƒ‰ã€å‹ãƒã‚§ãƒƒã‚¯ã€Lintã‚’ä¸¦è¡Œå®Ÿè¡Œ
pnpm run verify

# å€‹åˆ¥å®Ÿè¡Œ
pnpm run build      # ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
pnpm run typecheck  # ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‹ãƒã‚§ãƒƒã‚¯
pnpm run lint       # Lintãƒã‚§ãƒƒã‚¯
pnpm run lint:fix   # Lintè‡ªå‹•ä¿®æ­£
```

### ãã®ä»–

```bash
# ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼ã®ã¿èµ·å‹•
pnpm run mock

# é–‹ç™ºç”¨ãƒãƒ¼ãƒˆã‚’å¼·åˆ¶çµ‚äº†
pnpm run kill:ports

# ã™ã¹ã¦ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚¿ãƒ–ã‚’é–‹ã
pnpm run open
```

## ğŸ“¡ ãƒãƒ¼ãƒˆä¸€è¦§

- `4010`: Prismãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼
- `5173`: stack-heyapi-zod
- `5174`: stack-heyapi-valibot
- `5175`: stack-oats
- `5176`: stack-orval

## ğŸ—ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼**: pnpm workspace
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: React + Vite
- **è¨€èª**: TypeScript (strict mode)
- **çŠ¶æ…‹ç®¡ç†**: TanStack Query
- **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: Zod / Valibot
- **ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼**: Prism
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: Biome (Lint & Format)

## ğŸ† OpenAPI ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆãƒ„ãƒ¼ãƒ«æ¯”è¼ƒ

### OpenAPI YAML è¡¨ç¾åŠ›ãƒ©ãƒ³ã‚­ãƒ³ã‚°

#### ğŸ¥‡ 1ä½: **Orval** â˜…â˜…â˜…â˜…â˜…

OpenAPIã®æƒ…å ±ã‚’æœ€ã‚‚å¿ å®Ÿã«å†ç¾ã™ã‚‹æœ€å¼·ãƒ„ãƒ¼ãƒ«

**å„ªã‚Œã¦ã„ã‚‹ç‚¹:**
- âœ… `describe()` ã§å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ã‚’ä¿æŒ
- âœ… åˆ¶ç´„å€¤ã‚’å®šæ•°ã¨ã—ã¦å¤–å‡ºã—ï¼ˆå†åˆ©ç”¨å¯èƒ½ï¼‰
- âœ… JSDocã§APIæ“ä½œã®èª¬æ˜ã‚‚å«ã‚€
- âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®æ˜ç¤ºçš„ãªå®šç¾©
- âœ… æ­£è¦è¡¨ç¾ã‚’å¤‰æ•°ã¨ã—ã¦ä¿æŒ

---

#### ğŸ¥ˆ 2ä½: **openapi-zod-client** (oats) â˜…â˜…â˜…â˜…â˜†

å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯ã¨é«˜åº¦ãªæ—¥æ™‚å‡¦ç†ãŒç‰¹å¾´

**å„ªã‚Œã¦ã„ã‚‹ç‚¹:**
- âœ… `strict().passthrough()` ã§å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯
- âœ… `datetime({ offset: true })` ã§ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¯¾å¿œ
- âœ… `partial()` ã§éƒ¨åˆ†æ›´æ–°ã‚’é©åˆ‡ã«è¡¨ç¾

**ä¸è¶³ã—ã¦ã„ã‚‹ç‚¹:**
- âŒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ï¼ˆdescriptionï¼‰ãŒæ¬ è½
- âŒ APIæ“ä½œãƒ¬ãƒ™ãƒ«ã®æƒ…å ±ãªã—

---

#### ğŸ¥‰ 3ä½: **Hey API + Zod** â˜…â˜…â˜…â˜†â˜†

ã‚·ãƒ³ãƒ—ãƒ«ã§æ‰±ã„ã‚„ã™ã„ãŒã€æƒ…å ±ã®æ¬ è½ãŒç›®ç«‹ã¤

**å„ªã‚Œã¦ã„ã‚‹ç‚¹:**
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§èª­ã¿ã‚„ã™ã„ã‚¹ã‚­ãƒ¼ãƒ
- âœ… `datetime()` ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

**ä¸è¶³ã—ã¦ã„ã‚‹ç‚¹:**
- âŒ APIæ“ä½œç”¨ã‚¹ã‚­ãƒ¼ãƒãŒå†—é•·
- âŒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ãªã—
- âŒ åˆ¶ç´„å€¤ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰

---

#### ğŸ… 4ä½: **Hey API + Valibot** â˜…â˜…â˜†â˜†â˜†

é–¢æ•°å‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯é­…åŠ›çš„ã ãŒã€ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒæœªæˆç†Ÿ

**å„ªã‚Œã¦ã„ã‚‹ç‚¹:**
- âœ… `pipe()` ã§åˆ¶ç´„ã‚’é–¢æ•°çš„ã«è¡¨ç¾
- âœ… `isoTimestamp()` ã§ISO8601æ¤œè¨¼

**ä¸è¶³ã—ã¦ã„ã‚‹ç‚¹:**
- âŒ Zodã¨åŒæ§˜ã®å†—é•·æ€§
- âŒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ãªã—
- âŒ Valibotã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒã¾ã å°ã•ã„

### ğŸ“Š è©³ç´°æ¯”è¼ƒ

| æ©Ÿèƒ½                 | Orval       | openapi-zod-client | Hey API + Zod   | Hey API + Valibot |
| -------------------- | ----------- | ------------------ | --------------- | ----------------- |
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ã®ä¿æŒ | âœ…           | âŒ                  | âŒ               | âŒ                 |
| åˆ¶ç´„å€¤ã®å†åˆ©ç”¨æ€§     | âœ… å®šæ•°åŒ–    | âŒ                  | âŒ               | âŒ                 |
| ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®è¡¨ç¾   | âœ… æ˜ç¤ºçš„    | âœ… `.default()`     | âœ… `.default()`  | âœ… `.optional()`   |
| æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œ | âœ…           | âœ… offsetå¯¾å¿œ       | âœ…               | âœ… ISO8601         |
| éƒ¨åˆ†æ›´æ–°ã®è¡¨ç¾       | âœ…           | âœ… `.partial()`     | âœ… `.optional()` | âœ… `.optional()`   |
| APIæ“ä½œã®èª¬æ˜        | âœ… JSDocä»˜ã | âŒ ãªã—             | âš ï¸ éå‰°ã«è©³ç´°    | âš ï¸ éå‰°ã«è©³ç´°      |
| ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ          | âœ… å……å®Ÿ      | âœ… å……å®Ÿ             | âœ… å……å®Ÿ          | âš ï¸ ç™ºå±•é€”ä¸Š        |

### ğŸ’¡ ã€ŒAPIæ“ä½œã®èª¬æ˜ã€ã¨ã¯ï¼Ÿ

ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã«OpenAPIã§å®šç¾©ã—ãŸAPIæ“ä½œï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ã®èª¬æ˜ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¤ºã—ã¾ã™ï¼š

- **âœ… JSDocä»˜ãï¼ˆOrvalï¼‰**: å„APIæ“ä½œã« `@summary` ã‚„ `@description` ã¨ã—ã¦èª¬æ˜ãŒä»˜ä¸ã•ã‚Œã‚‹
  ```typescript
  /**
   * ã‚·ã‚¹ãƒ†ãƒ ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—ã—ã¾ã™
   * @summary å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—
   */
  ```

- **âŒ ãªã—ï¼ˆopenapi-zod-clientï¼‰**: ã‚¹ã‚­ãƒ¼ãƒã®ã¿ç”Ÿæˆã•ã‚Œã€APIæ“ä½œã®èª¬æ˜ã¯å«ã¾ã‚Œãªã„

- **âš ï¸ éå‰°ã«è©³ç´°ï¼ˆHey APIï¼‰**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ§‹é€ ï¼ˆbody/headers/path/queryï¼‰ã‚’å¿…è¦ä»¥ä¸Šã«è©³ç´°ã«å®šç¾©
  ```typescript
  export const zGetUsersApiData = z.object({
    body: z.never().optional(),
    headers: z.never().optional(),
    path: z.never().optional(),
    query: z.never().optional()
  });
  ```

### ğŸ¯ çµè«–

**Orval** ãŒæœ€ã‚‚OpenAPIã®æƒ…å ±ã‚’å¿ å®Ÿã«ä¿æŒã—ã€å®Ÿç”¨æ€§ã‚‚é«˜ã„ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ç‰¹ã«å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã®æ•´åˆæ€§ã‚’é‡è¦–ã™ã‚‹å ´åˆã«æ¨å¥¨ã•ã‚Œã¾ã™ã€‚

---

## ğŸ“¦ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆã¨è©³ç´°æ¯”è¼ƒ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€åŒã˜OpenAPIä»•æ§˜ã‹ã‚‰5ã¤ã®ç•°ãªã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§TypeScriptã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆã—ã€ãã‚Œãã‚Œã®ç‰¹å¾´ã‚’æ¯”è¼ƒã§ãã¾ã™ã€‚

### ğŸ” ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å                   | ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«                        | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ      | React Query | ç‰¹å¾´                           |
| ------------------------------ | --------------------------------------- | -------------- | --------------------- | ----------- | ------------------------------ |
| `stack-heyapi-zod`             | @hey-api/openapi-ts                     | Zod            | @hey-api/client-fetch | âœ…           | æ–°ã—ã„ãƒ„ãƒ¼ãƒ«ãƒã‚§ã‚¤ãƒ³           |
| `stack-heyapi-valibot`         | @hey-api/openapi-ts                     | Valibot        | @hey-api/client-fetch | âœ…           | é–¢æ•°å‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³           |
| `stack-openapi-typescript`     | openapi-typescript                      | ãªã—ï¼ˆå‹ã®ã¿ï¼‰ | openapi-fetch         | âœ…           | æœ€å°æ§‹æˆã€å‹å®‰å…¨æ€§é‡è¦–         |
| `stack-openapi-typescript-zod` | openapi-typescript + openapi-zod-client | Zod            | openapi-fetch         | âœ…           | å‹å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒã‚’åˆ†é›¢         |
| `stack-orval`                  | orval                                   | Zod            | axios                 | âœ…           | æœ€å¤šæ©Ÿèƒ½ã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘ |

### ğŸ“Š æ©Ÿèƒ½æ¯”è¼ƒè¡¨

| æ©Ÿèƒ½                          | Hey API (Zod) | Hey API (Valibot) | openapi-ts | openapi-ts + Zod | Orval     |
| ----------------------------- | ------------- | ----------------- | ---------- | ---------------- | --------- |
| **å‹å®šç¾©ç”Ÿæˆ**                | âœ…             | âœ…                 | âœ…          | âœ…                | âœ…         |
| **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**  | âœ…             | âœ…                 | âŒ          | âœ…                | âœ…         |
| **React Queryãƒ•ãƒƒã‚¯è‡ªå‹•ç”Ÿæˆ** | âœ…             | âœ…                 | âœ…          | âœ…                | âœ…         |
| **queryKeyå‹å®‰å…¨æ€§**          | â­â­â­â­â­         | â­â­â­â­â­             | â­â­â­        | â­â­â­              | â­â­â­â­      |
| **queryKeyç”Ÿæˆé–¢æ•°**          | âœ…             | âœ…                 | âŒ          | âŒ                | âœ…         |
| **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•åŒ…å«**        | â­â­â­â­â­â€»2       | â­â­â­â­â­â€»2           | âŒ          | âŒ                | â­â­â­â€»3     |
| **ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒƒã‚¯ç”Ÿæˆ**      | âŒ             | âŒ                 | âŒ          | âŒ                | âœ… (MSW)   |
| **ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ**          | âŒ             | âŒ                 | âŒ          | âŒ                | âœ… (Faker) |
| **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ç”Ÿæˆ**        | âœ…             | âœ…                 | âŒ          | âŒ                | âœ…         |
| **ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹å®šç¾©**    | âœ…             | âœ…                 | âœ…          | âœ…                | âœ…         |
| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ã®ä¿æŒ**      | âŒ             | âŒ                 | âŒ          | âŒ                | âœ…         |

â€»2: Hey APIã¯å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆpath/query/body/headersï¼‰ã‚’è‡ªå‹•çš„ã«queryKeyã«åŒ…å«
â€»3: Orvalã¯pathãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã¿è‡ªå‹•åŒ…å«ã€queryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æ‰‹å‹•ç®¡ç†ãŒå¿…è¦


### ğŸ¯ å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç‰¹å¾´ã¨ä½¿ã„åˆ†ã‘

#### 1. **Hey APIç³»ï¼ˆstack-heyapi-zod / stack-heyapi-valibotï¼‰**
- **å…±é€šç‚¹**ï¼š
  - åŒã˜ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆ@hey-api/openapi-tsï¼‰ã‚’ä½¿ç”¨
  - å°‚ç”¨ã®fetchã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ@hey-api/client-fetchï¼‰
  - React Queryãƒ•ãƒƒã‚¯ã®è‡ªå‹•ç”Ÿæˆ
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆSDKã®ç”Ÿæˆï¼ˆ`sdk.gen.ts`ï¼‰

- **ç›¸é•ç‚¹**ï¼š
  - **Zodç‰ˆ**: ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒå……å®Ÿã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒå¤§ãã„
  - **Valibotç‰ˆ**: ã‚ˆã‚Šè»½é‡ï¼ˆãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºå°ï¼‰ã€é–¢æ•°å‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼ˆ`pipe()`ã«ã‚ˆã‚‹åˆ¶ç´„ãƒã‚§ãƒ¼ãƒ³ï¼‰

- **é©ç”¨å ´é¢**: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æœ€æ–°ã®ãƒ„ãƒ¼ãƒ«ãƒã‚§ã‚¤ãƒ³ã‚’è©¦ã—ãŸã„å ´åˆ

#### 2. **openapi-typescriptï¼ˆæœ€å°æ§‹æˆï¼‰**
- **ç‰¹å¾´**ï¼š
  - å‹å®šç¾©ã®ã¿ç”Ÿæˆï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ï¼‰
  - æœ€å°ã®ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º
  - openapi-fetchã¨ã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªçµ±åˆ
  
- **é©ç”¨å ´é¢**: å‹å®‰å…¨æ€§ã®ã¿å¿…è¦ã§ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸è¦ãªå ´åˆ

#### 3. **openapi-typescript + Zod**
- **ç‰¹å¾´**ï¼š
  - å‹å®šç¾©ã¨Zodã‚¹ã‚­ãƒ¼ãƒã‚’åˆ¥ã€…ã«ç”Ÿæˆ
  - ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å¯èƒ½
  - å‹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ†é›¢ã«ã‚ˆã‚ŠæŸ”è»Ÿãªæ§‹æˆãŒå¯èƒ½
  
- **é©ç”¨å ´é¢**: å‹å®šç¾©ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç‹¬ç«‹ã—ã¦ç®¡ç†ã—ãŸã„å ´åˆ

#### 4. **Orvalï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘ï¼‰**
- **ç‰¹å¾´**ï¼š
  - æœ€ã‚‚å¤šæ©Ÿèƒ½ï¼ˆMSWãƒ¢ãƒƒã‚¯ã€Fakerãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼‰
  - OpenAPIä»•æ§˜ã®æƒ…å ±ã‚’æœ€ã‚‚å¿ å®Ÿã«ä¿æŒ
  - ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã”ã¨ã«ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ã•ã‚Œã‚‹è©³ç´°ãªç”Ÿæˆ
  
- **é©ç”¨å ´é¢**: å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–ãŒé‡è¦ãªå ´åˆ

### ğŸ”§ å®Ÿè£…ã®é•ã„ï¼ˆåŒã˜Zodã‚’ä½¿ã†3ã¤ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ¯”è¼ƒï¼‰

#### ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã®é•ã„

**Hey API + Zod**:
```typescript
// ã‚·ãƒ³ãƒ—ãƒ«ã ãŒæƒ…å ±ãŒå°‘ãªã„
export const zPost = z.object({
  id: z.number(),
  title: z.string().min(1).max(200),
  content: z.string(),
  authorId: z.number(),
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime()
});
```

**openapi-typescript + Zod**:
```typescript
// strictãƒ¢ãƒ¼ãƒ‰ã§å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯
export const postSchema = z.object({
  id: z.number().int(),
  title: z.string().min(1).max(200),
  content: z.string(),
  authorId: z.number().int(),
  createdAt: z.string().datetime({ offset: true }),
  updatedAt: z.string().datetime({ offset: true })
}).strict().passthrough();
```

**Orval**:
```typescript
// ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ã‚„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚‚ä¿æŒ
export const postSchema = z.object({
  id: z.number().describe('æŠ•ç¨¿ã®ä¸€æ„è­˜åˆ¥å­'),
  title: z.string().min(POST_TITLE_MIN).max(POST_TITLE_MAX).describe('æŠ•ç¨¿ã®ã‚¿ã‚¤ãƒˆãƒ«'),
  content: z.string().describe('æŠ•ç¨¿ã®æœ¬æ–‡'),
  authorId: z.number().describe('æŠ•ç¨¿è€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID'),
  createdAt: z.string().datetime().describe('æŠ•ç¨¿ã®ä½œæˆæ—¥æ™‚'),
  updatedAt: z.string().datetime().describe('æŠ•ç¨¿ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚')
});

// åˆ¶ç´„å€¤ã‚’å®šæ•°ã¨ã—ã¦å¤–å‡ºã—
export const POST_TITLE_MIN = 1;
export const POST_TITLE_MAX = 200;
```

### ğŸ”‘ queryKeyã®å‹å®‰å…¨æ€§æ¯”è¼ƒ

React Queryã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ã«ä½¿ç”¨ã•ã‚Œã‚‹`queryKey`ã®å®Ÿè£…ã‚’æ¯”è¼ƒï¼š

#### **Hey APIç³»ï¼ˆæœ€é«˜ã®å‹å®‰å…¨æ€§ï¼‰** â­â­â­â­â­
```typescript
// è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹queryKeyé–¢æ•°
const queryKey = getPostsApiQueryKey({ query: { limit: 10 } });
// => [{ _id: 'getPostsApi', baseUrl: 'http://...', query: { limit: 10 } }]

// ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè‡ªå‹•çš„ã«queryKeyã«å«ã¾ã‚Œã‚‹
queryClient.invalidateQueries({ 
  queryKey: getPostsByIdApiQueryKey({ path: { id: "123" } }) 
});
```
- âœ… å®Œå…¨ãªå‹å®‰å…¨æ€§
- âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è‡ªå‹•åŒ…å«
- âœ… å†åˆ©ç”¨å¯èƒ½ãªé–¢æ•°

#### **Orvalï¼ˆã‚·ãƒ³ãƒ—ãƒ«ã§å®Ÿç”¨çš„ï¼‰** â­â­â­â­
```typescript
// ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã”ã¨ã®é–¢æ•°
const queryKey = getGetPostsApiQueryKey(); // => ['/api/posts']
const queryKey = getGetPostsByIdApiQueryKey(id); // => ['/api/posts/123']

// invalidateã§ã®ä½¿ç”¨
queryClient.invalidateQueries({ 
  queryKey: getGetPostsApiQueryKey() 
});
```
- âœ… å‹å®‰å…¨ãªé–¢æ•°
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‘ã‚¹å½¢å¼
- âš ï¸ queryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æ‰‹å‹•ç®¡ç†

#### **openapi-typescriptï¼ˆæ¨™æº–çš„ï¼‰** â­â­â­
```typescript
// æ‰‹å‹•ã§queryKeyã‚’æ§‹ç¯‰
$api.useQuery("get", "/api/posts", { params: { query: { limit: 10 } } });
// å†…éƒ¨çš„ã«: ["get", "/api/posts", { params: { query: { limit: 10 } } }]

// invalidateã‚‚æ‰‹å‹•
queryClient.invalidateQueries({ 
  queryKey: ["get", "/api/posts"] 
});
```
- âš ï¸ æ‰‹å‹•æ§‹ç¯‰ãŒå¿…è¦
- âš ï¸ å‹æ¨è«–ã«ä¾å­˜
- âŒ å°‚ç”¨é–¢æ•°ãªã—

### ğŸ“Œ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•åŒ…å«ã®å…·ä½“ä¾‹

#### **Hey APIï¼ˆå…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•åŒ…å«ï¼‰** â­â­â­â­â­
```typescript
// queryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚è‡ªå‹•çš„ã«queryKeyã«å«ã¾ã‚Œã‚‹
const key1 = getPostsApiQueryKey({ query: { limit: 10, offset: 20 } });
// => [{ _id: 'getPostsApi', baseUrl: '...', query: { limit: 10, offset: 20 } }]

// pathãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚åŒæ§˜
const key2 = getPostsByIdApiQueryKey({ path: { id: "123" } });
// => [{ _id: 'getPostsByIdApi', baseUrl: '...', path: { id: "123" } }]

// bodyã‚„headersã‚‚å«ã¾ã‚Œã‚‹ï¼ˆPOSTãƒªã‚¯ã‚¨ã‚¹ãƒˆãªã©ï¼‰
const key3 = createPostApiQueryKey({ 
  body: { title: "æ–°è¦æŠ•ç¨¿" },
  headers: { "X-Custom": "value" }
});
```

#### **Orvalï¼ˆpathã®ã¿è‡ªå‹•ã€queryã¯æ‰‹å‹•ï¼‰** â­â­â­
```typescript
// pathãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯è‡ªå‹•çš„ã«URLã«åŸ‹ã‚è¾¼ã¾ã‚Œã‚‹
const key1 = getGetPostsByIdApiQueryKey("123");
// => ['/api/posts/123'] âœ…

// queryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æ‰‹å‹•ã§æ¸¡ã™å¿…è¦ãŒã‚ã‚‹
const key2 = getGetPostsApiQueryKey({ limit: 10, offset: 20 });
// => ['/api/posts', { limit: 10, offset: 20 }]

// ãŸã ã—ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—ã§ã‚‚å‘¼ã¹ã¦ã—ã¾ã†
const key3 = getGetPostsApiQueryKey();
// => ['/api/posts'] âš ï¸ queryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œãªã„ï¼
```

### ğŸ’¡ é¸æŠã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- **ã‚·ãƒ³ãƒ—ãƒ«ã•é‡è¦–** â†’ `stack-openapi-typescript`
- **æœ€æ–°ãƒ„ãƒ¼ãƒ«ãƒã‚§ã‚¤ãƒ³** â†’ `stack-heyapi-zod`
- **è»½é‡ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** â†’ `stack-heyapi-valibot`
- **æŸ”è»Ÿãªæ§‹æˆ** â†’ `stack-openapi-typescript-zod`
- **ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½** â†’ `stack-orval`
- **queryKeyå‹å®‰å…¨æ€§é‡è¦–** â†’ `stack-heyapi-*` ã¾ãŸã¯ `stack-orval`
